<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุงูุฌุฑุฏ ุงูุชููุงุฆู - ูุงุจุชูุจ</title>
    
    <!-- ููุชุจุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุฃุณุงุณูุฉ -->
    <script src="cdnjs.cloudflare.com"></script>
    <script src="unpkg.com"></script>

    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; text-align: center; margin: 0; padding: 20px; }
        .camera-box { border: 5px solid #007bff; border-radius: 15px; overflow: hidden; display: inline-block; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #status-msg { margin-top: 15px; font-size: 20px; color: #ffeb3b; background: #333; padding: 10px; border-radius: 10px; display: inline-block; }
        .log-container { margin-top: 20px; max-width: 500px; margin-left: auto; margin-right: auto; background: #000; color: #0f0; padding: 15px; border-radius: 10px; height: 150px; overflow-y: auto; text-align: right; border: 1px solid #444; }
    </style>
</head>
<body>

    <h2>๐ ุงุฎุชุจุงุฑ ูุธุงู ุงูุฌุฑุฏ ุงูุชููุงุฆู (ุงููุงุจุชูุจ)</h2>
    <p>ุจูุฌุฑุฏ ุชุญููู "ุงููุฎ"ุ ูุฌู ุฒุฌุงุฌุฉ ููุงู ุฃู ูุงุชูู ุฃูุงู ูุงููุฑุง ุงููุงุจุชูุจ</p>
    
    <div class="camera-box" id="canvas-container">
        <!-- ููุง ูุธูุฑ ุจุซ ุงููุงููุฑุง -->
    </div>

    <br>
    <div id="status-msg">ุฌุงุฑู ุชุญููู ุงูุฐูุงุก ุงูุงุตุทูุงุนู... ุงูุชุธุฑ ูุญุธุฉ</div>

    <div class="log-container" id="inventory-log">
        <b>ุณุฌู ุงูุฑุตุฏ ุงููุญุธู:</b><br>
    </div>

    <script>
        let video;
        let objectDetector;
        let detections = [];

        function setup() {
            // ุฅูุดุงุก ูุณุงุญุฉ ุงูุฑุณู
            let canvas = createCanvas(480, 360);
            canvas.parent('canvas-container');

            // ูุชุญ ูุงููุฑุง ุงููุงุจุชูุจ ุงููุชุงุญุฉ
            video = createCapture(VIDEO);
            video.size(480, 360);
            video.hide();

            // ุชุญููู ููุฏูู COCO-SSD ููุชุนุฑู ุงูุชููุงุฆู ุนูู ุงูุฃุดูุงุก
            objectDetector = ml5.objectDetector('cocossd', modelReady);
        }

        function modelReady() {
            document.getElementById('status-msg').innerText = "โ ุงููุธุงู ุฌุงูุฒ! ุถุน ุงูุฒุฌุงุฌุฉ ุฃูุงู ุงููุงููุฑุง";
            document.getElementById('status-msg').style.color = "#4caf50";
            // ุชุดุบูู ูุธููุฉ ุงูุฑุตุฏ ุงููุณุชูุฑ
            detectObjects();
        }

        function detectObjects() {
            // ูุทูุจ ูู ุงูููุฏูู ุชุญููู ุงูููุฏูู
            objectDetector.detect(video, (err, results) => {
                if (err) {
                    console.error(err);
                    return;
                }
                detections = results;
                
                // ุชุญุฏูุซ ุณุฌู ุงูุฌุฑุฏ ุฅุฐุง ุชู ุฑุตุฏ ุดูุก
                if (detections.length > 0) {
                    addToLog(detections[0].label);
                }
                
                // ุงุณุชูุฑุงุฑ ุงูุฑุตุฏ ูู ุญููุฉ ูุง ููุงุฆูุฉ
                detectObjects();
            });
        }

        function addToLog(label) {
            let log = document.getElementById('inventory-log');
            let time = new Date().toLocaleTimeString();
            
            // ุชุฑุฌูุฉ ุจุณูุทุฉ ูููุชุงุฆุฌ ุงููุดููุฑุฉ
            let name = label;
            if (label === 'bottle') name = "ุฒุฌุงุฌุฉ ููุงู";
            if (label === 'cell phone') name = "ููุจุงูู/ูุงุชู";
            if (label === 'person') name = "ุดุฎุต (ุฃูุช)";

            // ุฅุถุงูุฉ ุงูุณุทุฑ ููุณุฌู ูู ุงูุฃุนูู
            log.innerHTML = `<div>[${time}] ุชู ุฑุตุฏ: ${name}</div>` + log.innerHTML;
        }

        function draw() {
            // ุฑุณู ุงูููุฏูู ุนูู ุงูููุญุฉ
            image(video, 0, 0, width, height);

            // ุฑุณู ุงููุฑุจุนุงุช ูุงูุฃุณูุงุก ููู ุงูุฃุดูุงุก ุงูููุชุดูุฉ ุชููุงุฆูุงู
            for (let i = 0; i < detections.length; i++) {
                let obj = detections[i];
                stroke(0, 255, 0);
                strokeWeight(4);
                noFill();
                rect(obj.x, obj.y, obj.width, obj.height);
                
                noStroke();
                fill(0, 255, 0);
                textSize(20);
                text(obj.label, obj.x + 10, obj.y + 24);
            }
        }
    </script>
</body>
</html>
